<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>R and the Tidyverse for working with data: Visualisation with ggplot2</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png"><link rel="manifest" href="favicons/incubator/site.webmanifest"><link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-warning">
          <abbr title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
              Alpha
            </a>
            <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/02-data-visualisation.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg"></div>
    <div class="lesson-title-md">
      R and the Tidyverse for working with data
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            R and the Tidyverse for working with data
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R and the Tidyverse for working with data
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 8%" class="percentage">
    8%
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: 8%" aria-valuenow="8" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/02-data-visualisation.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-project-introduction.html">1. Introduction to R and RStudio</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        2. Visualisation with ggplot2
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#motivation">Motivation</a></li>
<li><a href="#getting-data-into-r">Getting data into R</a></li>
<li><a href="#introduction-to-ggplot2">Introduction to ggplot2</a></li>
<li><a href="#mapping-data">Mapping data</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-data-subsetting.html">3. Subsetting data with dplyr</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-data-sorting-pipes.html">4. Data sorting and pipes dplyr</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-data-plotting-scales.html">5. Data visualisation and scales</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-data-manipulation.html">6. Data manipulation with dplyr</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-data-reshaping.html">7. Reshaping data with tidyr</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-data-summaries.html">8. Data summaries with dplyr</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-data-complex-pipelines.html">9. Complex data pipelines</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-data-manipulation-across.html">10. Data manipulation across columns</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>

                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="01-project-introduction.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="03-data-subsetting.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="01-project-introduction.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Introduction to R
        </a>
        <a class="chapter-link float-end" href="03-data-subsetting.html" rel="next">
          Next: Subsetting data with...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Visualisation with ggplot2</h1>
        <p>Last updated on 2025-04-22 |

        <a href="https://github.com/athanasiamo/r-tidyverse-4-datasets/edit/main/episodes/02-data-visualisation.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How do I access my data in R?</li>
<li>How do I visualise my data with ggplot2?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Read data into R</li>
<li>To be able to use <code>ggplot2</code> to generate publication
quality graphics.</li>
<li>To understand the basic grammar of graphics, including the
aesthetics and geometry layers, adding statistics, transforming scales,
and colouring or panelling by groups.</li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Read data into R</li>
<li>Use ggplot2 to create different types of plots</li>
</ul></div>
</div>
</div>
<section><h2 class="section-heading" id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a></h2>
<hr class="half-width"><p>Plotting the data is one of the best ways to quickly explore it and
generate hypotheses about various relationships between variables.</p>
<p>There are several plotting systems in R, but today we will focus on
<code>ggplot2</code> which implements <strong>grammar of
graphics</strong> - a coherent system for describing components that
constitute visual representation of data. For more information regarding
principles and thinking behind <code>ggplot2</code> graphic system,
please refer to <a href="https://vita.had.co.nz/papers/layered-grammar.pdf" class="external-link">Layered grammar
of graphics</a> by Hadley Wickham (<span class="citation">@hadleywickham</span>).</p>
<p>The advantage of <code>ggplot2</code> is that it allows R users to
create publication quality graphics with a few lines of code.
<code>ggplot2</code> has a large user base and is constantly developed
and extended by the community.</p>
</section><section><h2 class="section-heading" id="getting-data-into-r">Getting data into R<a class="anchor" aria-label="anchor" href="#getting-data-into-r"></a></h2>
<hr class="half-width"><p>We will start by reading the data into R, from the <code>data</code>
folder you placed them in the last part of the introduction.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/penguins.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>This is our first bit of R code to “assign” data to an object in our
“R environment”. The R environment can be seen in the upper right hand
corner, and it lists everything R has access to at the moment. You
should see an object called “penguins”, which is a Dataset with 344
observations and 8 variables. We created this object with the line of
code we just ran. You can “read” the line, right to left as: “read the
penguins.csv into R, and assign (&lt;-) it to an object called
penguins”. The arrow, or assignment, is R’s way of creating new objects
to work on.</p>
<p><strong>Note</strong> a key difference from R and programs like SPSS
or excel, is that when data is used in R, we do not automatically alter
the data in the file we read it from. Everything we do with the penguins
data in R from now on, only happens in R, and does not change the
originating file. This way we cannot easily accidentally alter our raw
data, which is a very good thing.</p>
<div id="tip-we-can-inspect-the-data-in-several-ways" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div id="tip-we-can-inspect-the-data-in-several-ways" class="callout-inner">
<h3 class="callout-title">Tip: We can inspect the data in several ways</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Click the data name in the Environment, and the data opens as a tab
in the scripts pane.<br></li>
<li>Click the little arrow next to the data name in the Evironment, and
you’ll see a short preview of the data.<br></li>
<li>Type <code>penguins</code> in the R console, and a preview will be
shown of the data.<br></li>
</ol></div>
</div>
</div>
<p>The dataset contains the following fields:</p>
<ul><li>
<strong>species</strong>: penguin species</li>
<li>
<strong>island</strong>: island of observation</li>
<li>
<strong>bill_length_mm</strong>: bill length in millimetres</li>
<li>
<strong>bill_depth_mm</strong>: bill depth in millimetres</li>
<li>
<strong>flipper_length_mm</strong>: flipper length in
millimetres</li>
<li>
<strong>body_mass_g</strong>: body mass in grams</li>
<li>
<strong>sex</strong>: penguin sex</li>
<li>
<strong>year</strong>: year of observation</li>
</ul></section><section><h2 class="section-heading" id="introduction-to-ggplot2">Introduction to ggplot2<a class="anchor" aria-label="anchor" href="#introduction-to-ggplot2"></a></h2>
<hr class="half-width"><p><code>ggplot2</code> is a core member of <code>tidyverse</code>
family of packages. Installing and loading the package under the same
name will load all of the packages we will need for this workshop. Lets
get started!</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>── Attaching core tidyverse packages ──────────────────────── tidyverse <span class="dv">2</span>.<span class="fl">0.0</span> ──</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>✔ dplyr     <span class="dv">1</span>.<span class="fl">1.4</span>     ✔ readr     <span class="dv">2</span>.<span class="fl">1.5</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>✔ forcats   <span class="dv">1</span>.<span class="fl">0.0</span>     ✔ stringr   <span class="dv">1</span>.<span class="fl">5.1</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>✔ ggplot2   <span class="dv">3</span>.<span class="fl">5.1</span>     ✔ tibble    <span class="dv">3</span>.<span class="fl">2.1</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>✔ lubridate <span class="dv">1</span>.<span class="fl">9.4</span>     ✔ tidyr     <span class="dv">1</span>.<span class="fl">3.1</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>✔ purrr     <span class="dv">1</span>.<span class="fl">0.2</span>     </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>── Conflicts ────────────────────────────────────────── <span class="fu">tidyverse_conflicts</span>() ──</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>✖ dplyr<span class="sc">::</span><span class="fu">filter</span>() masks stats<span class="sc">::</span><span class="fu">filter</span>()</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>✖ dplyr<span class="sc">::</span><span class="fu">lag</span>()    masks stats<span class="sc">::</span><span class="fu">lag</span>()</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>ℹ Use the conflicted <span class="fu">package</span> (<span class="sc">&lt;</span>http<span class="sc">:</span><span class="er">//</span>conflicted.r<span class="sc">-</span>lib.org<span class="sc">/</span><span class="er">&gt;</span>) to force all conflicts to become errors</span></code></pre>
</div>
<p>Here’s a question that we would like to answer using
<code>penguins</code> data: <em>Do penguins with deep beaks also have
long beaks?</em> This might seem like a silly question, but it gets us
exploring our data.</p>
<p>To plot <code>penguins</code>, run the following code in the R-chunk
or in console. The following code will put <code>bill_depth_mm</code> on
the x-axis and <code>bill_length_mm</code> on the y-axis:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  )</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that we split the function into several lines. In R, any
function has a name and is followed by parentheses. Inside the
parentheses we place any information the function needs to run. Here, we
are using two main functions, <code>ggplot()</code> and
<code>geom_point()</code>. To save screen space, we have placed each
function on its own line, and also split up arguments into several
lines. How this is done depends on you, there are no real rules for
this. We will use the tidyverse coding style throughout this course, to
be consistent and also save space on the screen. The plus sign indicates
that the ggplot is not over yet and that the next line should be
interpreted as additional layer to the preceding <code>ggplot()</code>
function. In other words, when writing a <code>ggplot()</code> function
spanning several lines, the <code>+</code> sign goes at the end of the
line, not in the beginning.</p>
<p><strong>Note</strong> that in order to create a plot using
<code>ggplot2</code> system, you should start your command with
<code>ggplot()</code> function. It creates an empty coordinate system
and initializes the dataset to be used in the graph (which is supplied
as a first argument into the <code>ggplot()</code> function). In order
to create graphical representation of the data, we can add one or more
layers to our otherwise empty graph. Functions starting with the prefix
<code>geom_</code> create a visual representation of data. In this case
we added scattered points, using <code>geom_point()</code> function.
There are many <code>geoms</code> in <code>ggplot2</code>, some of which
we will learn in this lesson.</p>
<p><code>geom_</code> functions create <em>mapping</em> of variables
from the earlier defined dataset to certain aesthetic elements of the
graph, such as axis, shapes or colours. The first argument of any
<code>geom_</code> function expects the user to specify these mappings,
wrapped in the <code>aes()</code> (short for <em>aesthetics</em>)
function. In this case, we mapped <code>bill_depth_mm</code> and
<code>bill_length_mm</code> variables from <code>penguins</code> dataset
to x and y-axis, respectively (using <code>x</code> and <code>y</code>
arguments of <code>aes()</code> function).</p>
<div id="challenge-1a" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1a" class="callout-inner">
<h3 class="callout-title">Challenge 1a</h3>
<div class="callout-content">
<p>How has bill length changed over time? What do you observe?</p>
</div>
</div>
</div>
<div id="accordionHint1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint1" aria-expanded="false" aria-controls="collapseHint1">
  <h4 class="accordion-header" id="headingHint1"> Give me a hint </h4>
</button>
<div id="collapseHint1" class="accordion-collapse collapse" aria-labelledby="headingHint1" data-bs-parent="#accordionHint1">
<div class="accordion-body">
<p>The* <code>penguins</code> *dataset has a column called
<code>year</code>, which should appear on the x-axis.</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  )</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<div id="challenge-1b" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1b" class="callout-inner">
<h3 class="callout-title">Challenge 1b</h3>
<div class="callout-content">
<p>Try a different <code>geom_</code> function called
<code>geom_jitter</code>. How is that different from
<code>geom_point</code>?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  )</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="mapping-data">Mapping data<a class="anchor" aria-label="anchor" href="#mapping-data"></a></h2>
<hr class="half-width"><p>What if we want to combine graphs from the previous two challenges
and show the relationship between three variables in the same graph?
Turns out, we don’t necessarily need to use third geometrical dimension,
we can employ colour.</p>
<p>The following graph maps <code>island</code> variable from
<code>penguins</code> dataset to the <code>colour</code> aesthetic of
the plot. Let’s take a look:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm, </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>                  <span class="at">colour =</span> island)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  )</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>What will happen if you switch colour to also be by year? Is the
graph still useful? Why or why not? What is the difference in the plot
between when you colour by island and when you colour by year?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                  <span class="at">colour =</span> year)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  )</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Island is categorical character variable with a discrete range of
possible values. This, like the data type of factor, is represented with
colours by assigning a specific colour to each member of the discrete
set. <code>year</code> is a continuous numeric variable in which any
number of potential values can exist between known values. To represent
this, R uses a colour bar with a continuous gradient.</p>
</div>
</div>
</div>
</div>
<p>There are other aesthetics that can come handy. One of them is
<code>size</code>. The idea is that we can vary the size of data points
to illustrate another continuous variable, such as species bill depth.
Lets look at four dimensions at once!</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm, </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                  <span class="at">colour =</span> species, </span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                  <span class="at">size =</span> year)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  )</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>It might be even better to try another type of aesthetic, like shape,
for categorical data like species.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm, </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                  <span class="at">colour =</span> species, </span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                  <span class="at">shape =</span> species)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  )</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Playing around with different aesthetic mappings until you find
something that really makes the data “pop” is a good idea. A plot is
rarely made nice on the first try, we all try different configurations
until we find the one we like.</p>
</section><div class="section level1">
<h1 id="setting-values">Setting values<a class="anchor" aria-label="anchor" href="#setting-values"></a></h1>
<p>Until now, we explored different aesthetic properties of a graph
mapped to certain variables. What if you want to recolour or use a
certain shape to plot all data points? Well, that means that such colour
or shape will no longer be <em>mapped</em> to any data, so you need to
supply it to <code>geom_</code> function as a separate argument (outside
of the <code>mapping</code>). This is called “setting” in the
ggplot2-world. We “map” aesthetics to data columns, or we “set” single
values outside aesthetics to apply to the entire geom or plot. Here’s
our initial graph with all colours coloured in blue.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"blue"</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  )</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Once more, observe that the colour is now not mapped to any
particular variable from the <code>penguins</code> dataset and applies
equally to all data points, therefore it is outside the
<code>mapping</code> argument and is not wrapped into <code>aes()</code>
function. Note that set colours are supplied as characters (in
quotes).</p>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Change the transparency (alpha) of the data points by year.</p>
</div>
</div>
</div>
<div id="accordionHint2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint2" aria-expanded="false" aria-controls="collapseHint2">
  <h4 class="accordion-header" id="headingHint2"> Give me a hint </h4>
</button>
<div id="collapseHint2" class="accordion-collapse collapse" aria-labelledby="headingHint2" data-bs-parent="#accordionHint2">
<div class="accordion-body">
<p><code>alpha</code> takes a value from 0 (transparent) to 1
(solid).</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm, </span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>                  <span class="at">alpha =</span> year)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  )</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>Move the transparency outside the <code>aes()</code> and set it to
<code>0.5</code>. What can we benefit of each one of these methods?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<p><img src="fig/02-data-visualisation-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure">
Controlling the transparency can be a great way to “mute” the visual
effect of certain data, while still keeping it visible. Its a great tool
when you have many data points or if you have several geoms together,
like we will see soon.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="geometrical-objects">Geometrical objects<a class="anchor" aria-label="anchor" href="#geometrical-objects"></a></h1>
<p>Next, we will consider different options for <code>geoms</code>.
Using different <code>geom_</code> functions user can highlight
different aspects of data.</p>
<p>A useful geom function is <code>geom_boxplot()</code>. It adds a
layer with the “box and whiskers” plot illustrating the distribution of
values within categories. The following chart breaks down bill length by
island, where the box represents first and third quartile (the 25th and
75th percentiles), the middle bar signifies the median value and the
whiskers extent to cover 95% confidence interval. Outliers (outside of
the 95% confidence interval range) are shown separately.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> species, </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  )</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_boxplot()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-14-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Layers can be added on top of each other. In the following graph we
will place the boxplots <strong>over</strong> jittered points to see the
distribution of outliers more clearly. We can map two aesthetic
properties to the same variable. Here we will also use different colour
for each island.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins) <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> species, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm, </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                  <span class="at">colour =</span> species)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> species,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>                  <span class="at">y =</span> bill_length_mm)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  )</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_boxplot()</span><span class="st">`</span>).</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Now, this was slightly inefficient due to duplication of code - we
had to specify the same mappings for two layers. To avoid it, you can
move common arguments of <code>geom_</code> functions to the main
<code>ggplot()</code> function. In this case every layer will “inherit”
the same arguments, specified in the “parent” function.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> island, </span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                     <span class="at">y =</span> bill_length_mm)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">colour =</span> island)) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> .<span class="dv">6</span>)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_boxplot()</span><span class="st">`</span>).</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>You can still add layer-specific mappings or other arguments by
specifying them within individual geoms. Here, we’ve set the
transparency of the boxplot to .6, so we can see the points behind it,
and also mapped colour to island in the points. We would recommend
building each layer separately and then moving common arguments up to
the “parent” function.</p>
<p>We can use linear models to highlight differences in dependency
between bill length and body mass by island. Notice that we added a
separate argument to the <code>geom_smooth()</code> function to specify
the type of model we want <code>ggplot2</code> to built using the data
(linear model). The <code>geom_smooth()</code> function has also
helpfully provided confidence intervals, indicating “goodness of fit”
for each model (shaded gray area). For more information on statistical
models, please refer to help (by typing <code>?geom_smooth</code>)</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, </span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                     <span class="at">y =</span> bill_length_mm)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="ot">=</span> <span class="st">'y ~ x'</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_smooth()</span><span class="st">`</span>).</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>Modify the plot so the the points are coloured by island, but there
is a single regression line.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                     <span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">colour =</span> species),</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="ot">=</span> <span class="st">'y ~ x'</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_smooth()</span><span class="st">`</span>).</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<p><img src="fig/02-data-visualisation-rendered-unnamed-chunk-18-1.png" style="display: block; margin: auto;" class="figure">
In the graph above, each geom inherited all three mappings: x, y and
colour. If we want only single linear model to be built, we would need
to limit the effect of <code>colour</code> aesthetic to only
<code>geom_point()</code> function, by moving it from the “parent”
function to the layer where we want it to apply. Note, though, that
because we want the <code>colour</code> to be still mapped to the
<code>island</code> variable, it needs to be wrapped into
<code>aes()</code> function and supplied to <code>mapping</code>
argument.</p>
</div>
</div>
</div>
</div>
<div id="challenge-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6</h3>
<div class="callout-content">
<p>Add a regression line to the plot that plots one line for each
species, while also plotting one across all species.</p>
</div>
</div>
</div>
<div id="accordionHint3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint3" aria-expanded="false" aria-controls="collapseHint3">
  <h4 class="accordion-header" id="headingHint3"> Give me a hint </h4>
</button>
<div id="collapseHint3" class="accordion-collapse collapse" aria-labelledby="headingHint3" data-bs-parent="#accordionHint3">
<div class="accordion-body">
<p>Add another geom!</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7"> Show me the solution </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>           <span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> species),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">colour =</span> species)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"black"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="ot">=</span> <span class="st">'y ~ x'</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_smooth()</span><span class="st">`</span>).</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="ot">=</span> <span class="st">'y ~ x'</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_smooth()</span><span class="st">`</span>).</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<p><img src="fig/02-data-visualisation-rendered-unnamed-chunk-19-1.png" style="display: block; margin: auto;" class="figure">
Look at that! The data actually reveals something called the “simpsons
paradox”. It’s when a relationship looks to go in a specific direction,
but when looking into groups within the data the relationship is the
opposite. Here, the overall relationship between bill length and depths
looks negative, but when we take into account that there are different
species, the relationship is actually positive.</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="sub-plots-plot-panels">Sub-plots (plot panels)<a class="anchor" aria-label="anchor" href="#sub-plots-plot-panels"></a></h2>
<p>The last thing we will cover for plots is creating sub-plots. Often,
we’d like to create the same set of plots, but as distinctly different
subplots. This way, we dont need to map soo many aesthetics (it can end
up being really messy).</p>
<p>Lets say, the last plot we made, we want to understand if there are
also differences between male and female penguins. In ggplot2, this is
called a “facet”, and the function we use is called either
<code>facet_wrap</code> or <code>facet_grid</code>.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>          <span class="at">y =</span> bill_length_mm,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>          <span class="at">colour =</span> species)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sex)</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="ot">=</span> <span class="st">'y ~ x'</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_smooth()</span><span class="st">`</span>).</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-20-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The facet’s take formula arguments, meaning they contain the
<code>tilde</code> (~). The way often we think about it, trying to
“read” the code, is that we facet “over” sex (in this case).</p>
<p>This plot looks a little crazy though, as we have penguins with
missing sex information getting their own panel, and really, it makes
more sense to compare the sexes within each species rather than the
other way around. Let us swap the places of species and sex.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>          <span class="at">y =</span> bill_length_mm,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>          <span class="at">colour =</span> sex)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="ot">=</span> <span class="st">'y ~ x'</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_smooth()</span><span class="st">`</span>).</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-21-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The NA’s still look weird, but its definitely better, I think.</p>
<div id="challenge-7" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-7" class="callout-inner">
<h3 class="callout-title">Challenge 7</h3>
<div class="callout-content">
<p>To the plot we just made before, try adding another variable to facet
by. For instance, facet by species and island.</p>
</div>
</div>
</div>
<div id="accordionHint4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button hint-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHint4" aria-expanded="false" aria-controls="collapseHint4">
  <h4 class="accordion-header" id="headingHint4"> Give me a hint </h4>
</button>
<div id="collapseHint4" class="accordion-collapse collapse" aria-labelledby="headingHint4" data-bs-parent="#accordionHint4">
<div class="accordion-body">
<p>Add another facet variable with the <code>+</code></p>
</div>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8"> Show me the solution </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> bill_depth_mm, </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>          <span class="at">y =</span> bill_length_mm,</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>          <span class="at">colour =</span> sex)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> species <span class="sc">+</span> island)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="ot">=</span> <span class="st">'y ~ x'</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing non<span class="sc">-</span>finite outside the scale range</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>(<span class="st">`</span><span class="at">stat_smooth()</span><span class="st">`</span>).</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>Warning<span class="sc">:</span> Removed <span class="dv">2</span> rows containing missing values or values outside the scale range</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>(<span class="st">`</span><span class="at">geom_point()</span><span class="st">`</span>).</span></code></pre>
</div>
<figure><img src="fig/02-data-visualisation-rendered-unnamed-chunk-22-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="wrap-up">Wrap-up<a class="anchor" aria-label="anchor" href="#wrap-up"></a></h2>
<p>We learned about different parameters of ggplot functions, and how to
combine different geoms into more complex charts.</p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</div>



      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="01-project-introduction.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="03-data-subsetting.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="01-project-introduction.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Introduction to R
        </a>
        <a class="chapter-link float-end" href="03-data-subsetting.html" rel="next">
          Next: Subsetting data with...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/athanasiamo/r-tidyverse-4-datasets/edit/main/episodes/02-data-visualisation.Rmd" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/athanasiamo/r-tidyverse-4-datasets/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/athanasiamo/r-tidyverse-4-datasets/" class="external-link">Source</a></p>
				<p><a href="https://github.com/athanasiamo/r-tidyverse-4-datasets/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://athanasiamo.github.io/r-tidyverse-4-datasets/02-data-visualisation.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries, R, tidyverse",
  "name": "Visualisation with ggplot2",
  "creativeWorkStatus": "active",
  "url": "https://athanasiamo.github.io/r-tidyverse-4-datasets/02-data-visualisation.html",
  "identifier": "https://athanasiamo.github.io/r-tidyverse-4-datasets/02-data-visualisation.html",
  "dateCreated": "2025-01-07",
  "dateModified": "2025-04-22",
  "datePublished": "2025-04-22"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

